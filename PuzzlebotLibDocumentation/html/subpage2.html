<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Puzzlebot Library: Motor drivers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Puzzlebotlogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Puzzlebot Library
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('subpage2.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Motor drivers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#motor1">Pulse width modulation (PWM) signals</a></li>
<li class="level1"><a href="#motor2">Implementation</a></li>
<li class="level1"><a href="#motor3">Example</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="motor1"></a>
Pulse width modulation (PWM) signals</h1>
<p>Microcontrollers are a digital component, i.e. they operate based on signals which are purely “on” or “off”. As such, it is easy to control objects which are similarly digitally operated, however, there are often occasions when a component needs a variable voltage. For example, a DC motor is controlled by varying its input voltage such that 0V stops the motor, and at maximum voltage it runs at full speed. PWM is used to replicate an analogue signal with a digital signal.<br  />
 A PWM signal consists of a high frequency square wave, with a varying duty cycle. The duty cycle is the proportion of the time period that the signal is “on” for:</p>
<p><img src="pwm.jpg" alt="" class="inline"/></p>
<p>The signal is operated at a high enough frequency such that it has the effect of an analogue signal, with a voltage given by:<br  />
 \( V_{out}=DutyCycle \times V_{supply}\)</p>
<p>The frequency that should be chosen depends on the application. If the signal is being used to control an LED, to make it dimmable, then it should be higher than can be seen by the human eye, i.e. higher than 24 Hz. If it’s being used to control a motor, it should be higher than the limit of human hearing (20 kHz), as, although the motor moves as if it were being sent an analogue signal, the sound of the signal passing through the coils can still be heard.</p>
<h1><a class="anchor" id="motor2"></a>
Implementation</h1>
<p>The <a class="el" href="classMotorDriver.html" title="Motor class. Handles the speed of brushless or dc motors.">MotorDriver</a> class can control two types of motors by using pwm signals:</p><ul>
<li>dc motors. They need three pins :<ul>
<li><em>PinA</em> for configuring H-bridge for forward motion;</li>
<li><em>PinB</em> for configuring H-bridge for reverse motion;</li>
<li><em>PWM</em> for controlling the motor input voltage;</li>
</ul>
</li>
<li>brushless motors. They need two pins:<ul>
<li><em>DirPin</em> for contolling direction of rotation;</li>
<li><em>PWM</em> for controlling the motor input voltage;</li>
</ul>
</li>
</ul>
<p>Additional configurable parameters:</p><ul>
<li>PWM frequency (default 980);</li>
<li>PWM precision (default: 8 bits);</li>
</ul>
<h1><a class="anchor" id="motor3"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;Arduino.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;MotorDriver.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="classMotorDriver.html">MotorDriver</a> motor;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup()</div>
<div class="line">{</div>
<div class="line">  motor.<a class="code" href="classMotorDriver.html#adcffc5d750629862a59c992683b3d8e0">SetMotorType</a>(DC_MOTOR);            <span class="comment">// dc brushed motor</span></div>
<div class="line">  motor.<a class="code" href="classMotorDriver.html#a9f9a08bc627f65fb97ac1b28f688f12e">SetBaseFreq</a>(5000);                 <span class="comment">// pwm base frequency</span></div>
<div class="line">  motor.<a class="code" href="classMotorDriver.html#ad33bbf2bd248078b4cf81975f1431231">DriverSetup</a>(4, 0, 15,18);          <span class="comment">// PwmPin=4, pwm channel=0, PinA=15,PinB=18</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//main loop accelerates the motor to full speed forwards, then full speed reverse, and repeats</span></div>
<div class="line">  <span class="keywordtype">float</span> f;</div>
<div class="line">  <span class="keywordflow">for</span>(f = 0; f &lt; 1; f = f + 0.01)</div>
<div class="line">  {</div>
<div class="line">    motor.<a class="code" href="classMotorDriver.html#a909f34f4a21f380e5ab2fa8318a87e64">MotorWrite</a>(f);</div>
<div class="line">    delay(6);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">for</span>(f = 1; f &gt; -1; f = f - 0.01)</div>
<div class="line">  {</div>
<div class="line">    motor.<a class="code" href="classMotorDriver.html#a909f34f4a21f380e5ab2fa8318a87e64">MotorWrite</a>(f);</div>
<div class="line">    delay(6);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">for</span>(f = -1 ; f &lt; 0; f = f + 0.01)</div>
<div class="line">  {</div>
<div class="line">    motor.<a class="code" href="classMotorDriver.html#a909f34f4a21f380e5ab2fa8318a87e64">MotorWrite</a>(f);</div>
<div class="line">    delay(6);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aclassMotorDriver_html"><div class="ttname"><a href="classMotorDriver.html">MotorDriver</a></div><div class="ttdoc">Motor class. Handles the speed of brushless or dc motors.</div><div class="ttdef"><b>Definition:</b> <a href="MotorDriver_8h_source.html#l00021">MotorDriver.h:22</a></div></div>
<div class="ttc" id="aclassMotorDriver_html_a909f34f4a21f380e5ab2fa8318a87e64"><div class="ttname"><a href="classMotorDriver.html#a909f34f4a21f380e5ab2fa8318a87e64">MotorDriver::MotorWrite</a></div><div class="ttdeci">void MotorWrite(float PWM)</div><div class="ttdoc">Write the pwm value to the motor driver.</div></div>
<div class="ttc" id="aclassMotorDriver_html_a9f9a08bc627f65fb97ac1b28f688f12e"><div class="ttname"><a href="classMotorDriver.html#a9f9a08bc627f65fb97ac1b28f688f12e">MotorDriver::SetBaseFreq</a></div><div class="ttdeci">void SetBaseFreq(int BaseFreq)</div><div class="ttdoc">Set the base frequency for the pwm signal.</div></div>
<div class="ttc" id="aclassMotorDriver_html_ad33bbf2bd248078b4cf81975f1431231"><div class="ttname"><a href="classMotorDriver.html#ad33bbf2bd248078b4cf81975f1431231">MotorDriver::DriverSetup</a></div><div class="ttdeci">void DriverSetup(int PWMpin, int Channel, int PinA, int PinB=0)</div><div class="ttdoc">Sets up the pins and pwm channel of the motor driver.</div></div>
<div class="ttc" id="aclassMotorDriver_html_adcffc5d750629862a59c992683b3d8e0"><div class="ttname"><a href="classMotorDriver.html#adcffc5d750629862a59c992683b3d8e0">MotorDriver::SetMotorType</a></div><div class="ttdeci">void SetMotorType(int type)</div><div class="ttdoc">Set the motor type.</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
